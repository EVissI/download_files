services:
  worker:
    build: .
    command: python -m bot.workers.hint_worker
    environment:
      - REDIS_HOST=${REMOTE_REDIS_HOST}
      - REDIS_PORT=6379
      - REDIS_PASSWORD=${REDIS_PASSWORD}
      - REDIS_USER=${REDIS_USER}
      - REDIS_USER_PASSWORD=${REDIS_USER_PASSWORD}
      - PYTHONUNBUFFERED=1
    volumes:
      - ./bot:/app/bot
      - ./files:/app/files
      - ./log:/app/log
    restart: unless-stopped
    deploy:
      replicas: ${WORKERS_COUNT:-1}
    profiles: ["worker"]

networks:
  backgammon-net:
    driver: bridge